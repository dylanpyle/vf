(()=>{var m=class{constructor({ctx:e,x:i,y:t,color:o}){this.ctx=e,this.x=i,this.y=t,this.color=o}render({magnitude:e,direction:i}){let{ctx:t}=this,o=-1*(e/2),n=o+e;t.translate(this.x,this.y),t.rotate(i),t.beginPath(),t.lineTo(o,0),t.lineTo(n,0),t.moveTo(n,0),t.lineTo(n-7,-3),t.moveTo(n,0),t.lineTo(n-7,3),t.closePath(),t.strokeStyle=this.color,t.stroke(),t.setTransform(1,0,0,1,0,0)}},y=m;var g=class{constructor({ctx:e,x:i,y:t,color:o}){this.ctx=e,this.x=i,this.y=t,this.color=o}render({magnitude:e,direction:i}){let{ctx:t}=this,o=-1*(e/2),n=o+e;t.translate(this.x,this.y),t.rotate(i),t.beginPath(),t.lineTo(o,0),t.lineTo(n,0),t.closePath(),t.strokeStyle=this.color,t.stroke(),t.setTransform(1,0,0,1,0,0)}},P=g;var d=class{constructor({ctx:e,x:i,y:t}){this.ctx=e,this.x=i,this.y=t}render({magnitude:e,direction:i}){let{ctx:t}=this;t.beginPath(),t.arc(this.x,this.y,e/2,0,Math.PI*2),t.closePath(),t.fillStyle=`HSL(${i}rad, 70%, 60%)`,t.fill(),t.setTransform(1,0,0,1,0,0)}},b=d;var v=class{constructor({ctx:e,x:i,y:t}){this.ctx=e,this.x=i,this.y=t}render({magnitude:e,direction:i}){let{ctx:t}=this;t.beginPath(),t.arc(this.x,this.y,e/2,0,Math.PI*2),t.closePath(),t.strokeStyle=`HSL(${i}rad, 70%, 60%)`,t.stroke(),t.setTransform(1,0,0,1,0,0)}},M=v;var x=class{constructor({ctx:e,x:i,y:t,color:o}){this.ctx=e,this.x=i,this.y=t,this.color=o}render({magnitude:e,direction:i}){let{ctx:t}=this;t.font="10px sans-serif",t.fillStyle=this.color,t.fillText(`(${this.x}, ${this.y})
m:${e.toFixed(2)} d:${i.toFixed(2)}`,this.x,this.y),t.setTransform(1,0,0,1,0,0)}},C=x;var O=(s,e)=>(Math.PI*2+Math.atan2(-1*e,s))%(Math.PI*2);function X(s){switch(s){case"ARROW":return y;case"LINE":return P;case"DOT":return b;case"CIRCLE":return M;case"DEBUG":return C}}var f=class{constructor({el:e,vx:i,vy:t,spacing:o,foregroundColor:n,backgroundColor:a,type:r,clamp:l}){this.points=[];this.logicalMouseX=0;this.logicalMouseY=0;this.onMouseMove=e=>{this.updateWithMousePosition(e.clientX,e.clientY)};this.onTouchMove=e=>{e.preventDefault(),this.updateWithMousePosition(e.touches[0].clientX,e.touches[0].clientY)};this.render=()=>{this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,0,this.width,this.height);for(let e of this.points)e.element.render(this.getPointElementProperties(e)),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio);requestAnimationFrame(this.render)};this.updateWithMousePosition=(e,i)=>{let[t,o]=this.physicalToLogical(e,i);this.logicalMouseX=t,this.logicalMouseY=o};this.onWindowResize=()=>{this.setUpScene()};this.el=e;let h=e.getContext("2d");if(this.width=this.el.clientWidth,this.height=this.el.clientHeight,this.backgroundColor=a,this.foregroundColor=n,this.type=r,!h)throw new Error("Could not get canvas context");this.ctx=h,this.xEquation=i,this.yEquation=t,this.spacing=o,this.clamp=l,e.addEventListener("mousemove",this.onMouseMove),e.addEventListener("touchmove",this.onTouchMove),window.addEventListener("resize",this.onWindowResize),this.setUpScene(),this.render()}getPointElementProperties(e){let i=r=>{let l=Date.now()/1e4%1;return new Function("x","y","mX","mY","t",`with (Math) { return ${r}; }`)(e.logicalX,e.logicalY,this.logicalMouseX,this.logicalMouseY,l)},t=i(this.xEquation),o=i(this.yEquation),n=Math.sqrt(Math.pow(t,2)+Math.pow(o,2));return this.clamp&&(n=Math.min(n,1)),{magnitude:n*this.spacing,direction:O(t,o)}}getLogicalBounds(){let e=this.width/this.height;return e>1?[[-1,-1/e],[1,1/e]]:[[e/-1,-1],[e/1,1]]}physicalToLogical(e,i){let[[t,o],[n,a]]=this.getLogicalBounds(),[r,l]=[this.width,this.height],h=e/r,p=1-i/l,u=t+(n-t)*h,R=o+(a-o)*p;return[u,R]}setUpScene(){this.width=this.el.clientWidth,this.height=this.el.clientHeight;let e=window.devicePixelRatio;this.el.width=this.width*e,this.el.height=this.height*e,this.ctx.scale(e,e),this.points=[];let[i,t]=[0,0],[o,n]=[this.width,this.height];for(let a=i;a<o;a+=this.spacing)for(let r=t;r<n;r+=this.spacing){let l=X(this.type),h=new l({ctx:this.ctx,x:a,y:r,color:this.foregroundColor,type:this.type}),[p,u]=this.physicalToLogical(a,r);this.points.push({element:h,logicalX:p,logicalY:u,physicalX:a,physicalY:r})}}},w=f;var E=document.querySelector(".app-canvas");if(!E)throw new Error("Missing .app-canvas element");var Y=new URL(window.location.href),c=Y.searchParams,L=c.get("vx")||"Math.cos((y - mY + 0.78) * 2)",S=c.get("vy")||"Math.sin((x - mX) * 2)",k=c.get("bg")||"#000",q=c.get("fg")||"#fff",D=c.get("type")||"ARROW",T=c.get("l"),H=T?parseInt(T,10):40,I=c.get("clamp")==="true";new w({el:E,vx:L,vy:S,spacing:H,foregroundColor:q,backgroundColor:k,type:D,clamp:I});var W=window.location.search===""||c.get("edit")==="true";if(W){let s=document.querySelector(".config-form");if(!s)throw new Error("Missing .config-form element");for(let[e,i]of c){let t=s.elements.namedItem(e);t&&(t.value=i)}s.style.display="block"}})();
